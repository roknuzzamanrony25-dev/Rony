<!DOCTYPE html>
<html>
<head><title>Live Monitor</title></head>
<body style="text-align:center; background:#111; color:#fff; font-family:sans-serif;">
    <h2>ðŸ“º Live Remote Monitor</h2>
    <video id="live" autoplay playsinline controls style="width:80%; max-width:700px; background:#000; border:2px solid #333;"></video>
    
    <div style="margin-top:20px;">
        <button onclick="switchCam()" style="padding:15px 30px; font-size:18px; background:red; color:white; border:none; border-radius:50px; cursor:pointer; font-weight:bold;">
            ðŸ”„ Switch Front/Back Camera
        </button>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
        const socket = io();
        const video = document.getElementById("live");
        const pc = new RTCPeerConnection({
            iceServers: [{ urls: "stun:stun.l.google.com:19302" }]
        });

        socket.emit("ready");

        pc.ontrack = e => { video.srcObject = e.streams[0]; };

        socket.on("offer", async offer => {
            await pc.setRemoteDescription(new RTCSessionDescription(offer));
            const answer = await pc.createAnswer();
            await pc.setLocalDescription(answer);
            socket.emit("answer", answer);
        });

        pc.onicecandidate = e => { if (e.candidate) socket.emit("ice-candidate", e.candidate); };
        socket.on("ice-candidate", async c => { try { await pc.addIceCandidate(new RTCIceCandidate(c)); } catch(e) {} });

        function switchCam() {
            console.log("Requesting Switch...");
            socket.emit("switch-camera");
        }
    </script>
</body>
</html>

